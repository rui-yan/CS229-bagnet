ruiyan@cnn-patch-project-vm:~/CS229-final-project$ python run_bagnet33.py 
PyTorch Version:  1.2.0
Torchvision Version:  0.4.0a0+6b959ee
[Using cuda:0 ...]
==> [Preparing data ....]
Initializing Datasets and Dataloaders...
==> Bagnet-33 model
Linear(in_features=2048, out_features=5, bias=True)
Params to learn:
	 fc.weight
	 fc.bias
[Using CrossEntropyLoss ...]
[Training the model begun ...]
Epoch 0/49
----------
train Loss: 1.0969 Acc: 0.6105
val Loss: 0.6926 Acc: 0.7977

Epoch 1/49
----------
train Loss: 0.7245 Acc: 0.7657
val Loss: 0.6025 Acc: 0.7909

Epoch 2/49
----------
train Loss: 0.6156 Acc: 0.8028
val Loss: 0.4827 Acc: 0.8491

Epoch 3/49
----------
train Loss: 0.5642 Acc: 0.8090
val Loss: 0.4501 Acc: 0.8469

Epoch 4/49
----------
train Loss: 0.5412 Acc: 0.8204
val Loss: 0.4060 Acc: 0.8777

Epoch 5/49
----------
train Loss: 0.5340 Acc: 0.8217
val Loss: 0.4403 Acc: 0.8457

Epoch 6/49
----------
train Loss: 0.5161 Acc: 0.8217
val Loss: 0.4063 Acc: 0.8617

Epoch 7/49
----------
train Loss: 0.5120 Acc: 0.8207
val Loss: 0.3742 Acc: 0.8777

Epoch 8/49
----------
train Loss: 0.4945 Acc: 0.8318
val Loss: 0.3623 Acc: 0.8823

Epoch 9/49
----------
train Loss: 0.4741 Acc: 0.8334
val Loss: 0.3655 Acc: 0.8800

Epoch 10/49
----------
train Loss: 0.4661 Acc: 0.8350
val Loss: 0.3816 Acc: 0.8731

Epoch 11/49
----------
train Loss: 0.4752 Acc: 0.8282
val Loss: 0.3379 Acc: 0.8914

Epoch 12/49
----------
train Loss: 0.4493 Acc: 0.8376
val Loss: 0.3522 Acc: 0.8880

Epoch 13/49
----------
train Loss: 0.4516 Acc: 0.8357
val Loss: 0.3410 Acc: 0.8903

Epoch 14/49
----------
train Loss: 0.4352 Acc: 0.8529
val Loss: 0.3236 Acc: 0.8891

Epoch 15/49
----------
train Loss: 0.4490 Acc: 0.8480
val Loss: 0.3430 Acc: 0.8800

Epoch 16/49
----------
train Loss: 0.4401 Acc: 0.8487
val Loss: 0.3040 Acc: 0.9029

Epoch 17/49
----------
train Loss: 0.4376 Acc: 0.8396
val Loss: 0.3205 Acc: 0.8949

Epoch 18/49
----------
train Loss: 0.4204 Acc: 0.8526
val Loss: 0.3102 Acc: 0.8960

Epoch 19/49
----------
train Loss: 0.4126 Acc: 0.8558
val Loss: 0.3287 Acc: 0.8914

Epoch 20/49
----------
train Loss: 0.4261 Acc: 0.8503
val Loss: 0.3625 Acc: 0.8720

Epoch 21/49
----------
train Loss: 0.4028 Acc: 0.8650
val Loss: 0.3376 Acc: 0.8891

Epoch 22/49
----------
train Loss: 0.4383 Acc: 0.8396
val Loss: 0.3123 Acc: 0.9040

Epoch 23/49
----------
train Loss: 0.4294 Acc: 0.8503
val Loss: 0.2966 Acc: 0.9063

Epoch 24/49
----------
train Loss: 0.4072 Acc: 0.8555
val Loss: 0.3083 Acc: 0.9017

Epoch 25/49
----------
train Loss: 0.4025 Acc: 0.8653
val Loss: 0.3111 Acc: 0.8937

Epoch 26/49
----------
train Loss: 0.4074 Acc: 0.8633
val Loss: 0.3143 Acc: 0.9040

Epoch 27/49
----------
train Loss: 0.4018 Acc: 0.8607
val Loss: 0.2983 Acc: 0.9109

Epoch 28/49
----------
train Loss: 0.3988 Acc: 0.8516
val Loss: 0.3014 Acc: 0.8994

Epoch 29/49
----------
train Loss: 0.4098 Acc: 0.8578
val Loss: 0.3284 Acc: 0.8880

Epoch 30/49
----------
train Loss: 0.3939 Acc: 0.8594
val Loss: 0.3308 Acc: 0.8903

Epoch 31/49
----------
train Loss: 0.3902 Acc: 0.8578
val Loss: 0.2997 Acc: 0.9051

Epoch 32/49
----------
train Loss: 0.4017 Acc: 0.8578
val Loss: 0.2905 Acc: 0.9109

Epoch 33/49
----------
train Loss: 0.4052 Acc: 0.8542
val Loss: 0.2822 Acc: 0.9086

Epoch 34/49
----------
train Loss: 0.3967 Acc: 0.8604
val Loss: 0.2882 Acc: 0.9109

Epoch 35/49
----------
train Loss: 0.3908 Acc: 0.8659
val Loss: 0.2784 Acc: 0.9131

Epoch 36/49
----------
train Loss: 0.3909 Acc: 0.8672
val Loss: 0.2888 Acc: 0.9109

Epoch 37/49
----------
train Loss: 0.3903 Acc: 0.8630
val Loss: 0.2837 Acc: 0.9074

Epoch 38/49
----------
train Loss: 0.4051 Acc: 0.8506
val Loss: 0.2883 Acc: 0.9097

Epoch 39/49
----------
train Loss: 0.3795 Acc: 0.8676
val Loss: 0.2799 Acc: 0.9189

Epoch 40/49
----------
train Loss: 0.3825 Acc: 0.8718
val Loss: 0.2912 Acc: 0.9086

Epoch 41/49
----------
train Loss: 0.3746 Acc: 0.8734
val Loss: 0.2828 Acc: 0.9166

Epoch 42/49
----------
train Loss: 0.3998 Acc: 0.8607
val Loss: 0.3013 Acc: 0.9040

Epoch 43/49
----------
train Loss: 0.4031 Acc: 0.8552
val Loss: 0.2843 Acc: 0.9086

Epoch 44/49
----------
train Loss: 0.3687 Acc: 0.8750
val Loss: 0.2865 Acc: 0.9074

Epoch 45/49
----------
train Loss: 0.3756 Acc: 0.8698
val Loss: 0.3030 Acc: 0.9029

Epoch 46/49
----------
train Loss: 0.3629 Acc: 0.8737
val Loss: 0.2984 Acc: 0.8971

Epoch 47/49
----------
train Loss: 0.3814 Acc: 0.8584
val Loss: 0.2954 Acc: 0.9006

Epoch 48/49
----------
train Loss: 0.3843 Acc: 0.8666
val Loss: 0.3090 Acc: 0.8914

Epoch 49/49
----------
train Loss: 0.3667 Acc: 0.8767
val Loss: 0.2794 Acc: 0.9131

Training complete in 153m 45s
Best val Acc: 0.918857

==> Saving model...

==> Saving loss and accuracy data...

==> Testing model...

Test Loss: 0.289078
Test Accuracy: 90% (29/32)


Test Loss: 0.353762
Test Accuracy: 87% (56/64)


Test Loss: 0.357358
Test Accuracy: 86% (83/96)


Test Loss: 0.313947
Test Accuracy: 87% (112/128)


Test Loss: 0.281415
Test Accuracy: 89% (143/160)


Test Loss: 0.271020
Test Accuracy: 89% (172/192)


Test Loss: 0.263846
Test Accuracy: 90% (202/224)


Test Loss: 0.264281
Test Accuracy: 89% (230/256)


Test Loss: 0.245551
Test Accuracy: 90% (261/288)


Test Loss: 0.231715
Test Accuracy: 91% (293/320)


Test Loss: 0.245191
Test Accuracy: 91% (322/352)


Test Loss: 0.244716
Test Accuracy: 91% (343/375)