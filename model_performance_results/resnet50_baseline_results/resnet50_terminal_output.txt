ruiyan@cnn-patch-project-vm:~/CS229-final-project$ python run_resnet50.py 
PyTorch Version:  1.2.0
Torchvision Version:  0.4.0a0+6b959ee

[Using cuda:0 ...]

==> [Preparing data ....]
Initializing Datasets and Dataloaders...

==> Resnet-50 model
Linear(in_features=2048, out_features=5, bias=True)
Params to learn:
	 fc.weight
	 fc.bias

[Using CrossEntropyLoss ...]

[Training the model begun ...]

Epoch 0/49
----------
train Loss: 0.9887 Acc: 0.6619
val Loss: 0.5893 Acc: 0.8434

Epoch 1/49
----------
train Loss: 0.5981 Acc: 0.8064
val Loss: 0.4692 Acc: 0.8617

Epoch 2/49
----------
train Loss: 0.5255 Acc: 0.8226
val Loss: 0.4413 Acc: 0.8411

Epoch 3/49
----------
train Loss: 0.4889 Acc: 0.8318
val Loss: 0.3849 Acc: 0.8811

Epoch 4/49
----------
train Loss: 0.4561 Acc: 0.8461
val Loss: 0.3465 Acc: 0.8903

Epoch 5/49
----------
train Loss: 0.4562 Acc: 0.8412
val Loss: 0.3430 Acc: 0.8789

Epoch 6/49
----------
train Loss: 0.4209 Acc: 0.8588
val Loss: 0.3191 Acc: 0.9029

Epoch 7/49
----------
train Loss: 0.4193 Acc: 0.8519
val Loss: 0.3252 Acc: 0.8857

Epoch 8/49
----------
train Loss: 0.3892 Acc: 0.8695
val Loss: 0.3361 Acc: 0.8857

Epoch 9/49
----------
train Loss: 0.4158 Acc: 0.8510
val Loss: 0.3144 Acc: 0.8949

Epoch 10/49
----------
train Loss: 0.3996 Acc: 0.8614
val Loss: 0.2969 Acc: 0.9017

Epoch 11/49
----------
train Loss: 0.3751 Acc: 0.8708
val Loss: 0.3139 Acc: 0.8869

Epoch 12/49
----------
train Loss: 0.3701 Acc: 0.8689
val Loss: 0.3147 Acc: 0.8766

Epoch 13/49
----------
train Loss: 0.3839 Acc: 0.8614
val Loss: 0.2881 Acc: 0.8994

Epoch 14/49
----------
train Loss: 0.3706 Acc: 0.8672
val Loss: 0.2856 Acc: 0.9017

Epoch 15/49
----------
train Loss: 0.3625 Acc: 0.8711
val Loss: 0.2791 Acc: 0.9063

Epoch 16/49
----------
train Loss: 0.3776 Acc: 0.8669
val Loss: 0.2773 Acc: 0.9017

Epoch 17/49
----------
train Loss: 0.3618 Acc: 0.8646
val Loss: 0.2803 Acc: 0.9051

Epoch 18/49
----------
train Loss: 0.3605 Acc: 0.8702
val Loss: 0.2970 Acc: 0.8891

Epoch 19/49
----------
train Loss: 0.3422 Acc: 0.8838
val Loss: 0.2745 Acc: 0.9086

Epoch 20/49
----------
train Loss: 0.3493 Acc: 0.8776
val Loss: 0.2857 Acc: 0.9017

Epoch 21/49
----------
train Loss: 0.3509 Acc: 0.8724
val Loss: 0.2762 Acc: 0.9017

Epoch 22/49
----------
train Loss: 0.3421 Acc: 0.8822
val Loss: 0.2800 Acc: 0.8994

Epoch 23/49
----------
train Loss: 0.3138 Acc: 0.8965
val Loss: 0.2672 Acc: 0.9063

Epoch 24/49
----------
train Loss: 0.3358 Acc: 0.8741
val Loss: 0.2642 Acc: 0.9051

Epoch 25/49
----------
train Loss: 0.3528 Acc: 0.8705
val Loss: 0.2713 Acc: 0.9017

Epoch 26/49
----------
train Loss: 0.3324 Acc: 0.8815
val Loss: 0.2668 Acc: 0.9074

Epoch 27/49
----------
train Loss: 0.3560 Acc: 0.8750
val Loss: 0.2548 Acc: 0.9131

Epoch 28/49
----------
train Loss: 0.3496 Acc: 0.8737
val Loss: 0.2643 Acc: 0.9051

Epoch 29/49
----------
train Loss: 0.3317 Acc: 0.8799
val Loss: 0.2683 Acc: 0.9086

Epoch 30/49
----------
train Loss: 0.3238 Acc: 0.8825
val Loss: 0.2530 Acc: 0.9143

Epoch 31/49
----------
train Loss: 0.3294 Acc: 0.8838
val Loss: 0.2563 Acc: 0.9109

Epoch 32/49
----------
train Loss: 0.3057 Acc: 0.8910
val Loss: 0.2575 Acc: 0.9143

Epoch 33/49
----------
train Loss: 0.3299 Acc: 0.8770
val Loss: 0.2690 Acc: 0.9074

Epoch 34/49
----------
train Loss: 0.3240 Acc: 0.8874
val Loss: 0.2498 Acc: 0.9143

Epoch 35/49
----------
train Loss: 0.3138 Acc: 0.8864
val Loss: 0.2706 Acc: 0.9029

Epoch 36/49
----------
train Loss: 0.3172 Acc: 0.8884
val Loss: 0.2517 Acc: 0.9211

Epoch 37/49
----------
train Loss: 0.3330 Acc: 0.8793
val Loss: 0.2648 Acc: 0.9109

Epoch 38/49
----------
train Loss: 0.3212 Acc: 0.8819
val Loss: 0.2711 Acc: 0.9063

Epoch 39/49
----------
train Loss: 0.3146 Acc: 0.8903
val Loss: 0.2504 Acc: 0.9143

Epoch 40/49
----------
train Loss: 0.3070 Acc: 0.8923
val Loss: 0.2645 Acc: 0.9097

Epoch 41/49
----------
train Loss: 0.3098 Acc: 0.8881
val Loss: 0.2571 Acc: 0.9143

Epoch 42/49
----------
train Loss: 0.3067 Acc: 0.8933
val Loss: 0.2671 Acc: 0.9143

Epoch 43/49
----------
train Loss: 0.3066 Acc: 0.8936
val Loss: 0.2488 Acc: 0.9131

Epoch 44/49
----------
train Loss: 0.3177 Acc: 0.8822
val Loss: 0.2490 Acc: 0.9086

Epoch 45/49
----------
train Loss: 0.3261 Acc: 0.8832
val Loss: 0.2498 Acc: 0.9086

Epoch 46/49
----------
train Loss: 0.3048 Acc: 0.8959
val Loss: 0.2776 Acc: 0.8937

Epoch 47/49
----------
train Loss: 0.3086 Acc: 0.8868
val Loss: 0.2619 Acc: 0.9131

Epoch 48/49
----------
train Loss: 0.3147 Acc: 0.8894
val Loss: 0.2627 Acc: 0.9109

Epoch 49/49
----------
train Loss: 0.3255 Acc: 0.8855
val Loss: 0.2699 Acc: 0.9109

Training complete in 33m 2s
Best val Acc: 0.921143


==> Saving model...


==> Saving loss and accuracy data...


==> Testing model...

Test Loss: 0.310414
Test Accuracy: 87% (28/32)

Test Loss: 0.358341
Test Accuracy: 82% (53/64)

Test Loss: 0.280909
Test Accuracy: 87% (84/96)

Test Loss: 0.245039
Test Accuracy: 89% (114/128)

Test Loss: 0.253459
Test Accuracy: 89% (143/160)

Test Loss: 0.254735
Test Accuracy: 90% (173/192)

Test Loss: 0.246315
Test Accuracy: 90% (203/224)

Test Loss: 0.239715
Test Accuracy: 91% (233/256)

Test Loss: 0.232706
Test Accuracy: 91% (264/288)

Test Loss: 0.220947
Test Accuracy: 92% (296/320)

Test Loss: 0.225590
Test Accuracy: 92% (326/352)

Test Loss: 0.220597
Test Accuracy: 92% (347/375)